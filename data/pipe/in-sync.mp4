GRABBER_DEVICE=/dev/video0
WEBCAM_DEVICE=/dev/video1


DST=~/webcast/test1
CAM=${DST}/camera.mp4
SLD=${DST}/slides.mp4

rm -f $SLD $CAM
mkdir -p $DST

gst-launch-1.0 -e \
    v4l2src device=${WEBCAM_DEVICE} \
        ! "video/x-raw, width=(int)320, height=(int)240, format=(string)I420, framerate=(fraction)30/1" \
        ! x264enc speed-preset=fast \
        ! mp4mux name=mux_cam \
        ! filesink location="${CAM}" \
	v4l2src device=${GRABBER_DEVICE} \
        ! "video/x-raw, width=(int)1024, height=(int)768, format=(string)YUY2, framerate=(fraction)30/1" \
        ! videoconvert \
        ! "video/x-raw, width=(int)1024, height=(int)768, format=(string)I420, framerate=(fraction)30/1" \
        ! x264enc speed-preset=fast \
        ! mp4mux name=mux_sld \
        ! filesink location="${SLD}" \
    pulsesrc \
        ! audioconvert \
        ! audio/x-raw, rate=44100, channels=2 \
        ! lamemp3enc \
        ! queue \
        ! mux_cam.
